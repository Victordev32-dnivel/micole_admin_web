<div class="modal-container">
  <div class="modal-header">
    <h2 mat-dialog-title>
      Agregar {{
        tipo === 'grados' ? 'Grado' :
        tipo === 'niveles' ? 'Nivel' :
        tipo === 'secciones' ? 'Sección' : 'Salón'
      }}
    </h2>
  </div>

  <div class="modal-content" mat-dialog-content>
    <form [formGroup]="addForm" (ngSubmit)="onSubmit()">
      
      <!-- Campo común para todos los tipos -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre *</mat-label>
        <input matInput formControlName="nombre" required placeholder="Ingrese el nombre">
        <mat-error *ngIf="addForm.get('nombre')?.hasError('required')">
          El nombre es requerido
        </mat-error>
        <mat-error *ngIf="addForm.get('nombre')?.hasError('maxlength')">
          Máximo 100 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Campos adicionales para salones -->
      <ng-container *ngIf="tipo === 'salones'">
        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Hora Inicio *</mat-label>
            <input matInput formControlName="horaInicio" placeholder="08:00:00" required>
            <mat-error *ngIf="addForm.get('horaInicio')?.hasError('required')">
              La hora de inicio es requerida
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Hora Fin *</mat-label>
            <input matInput formControlName="horaFin" placeholder="18:00:00" required>
            <mat-error *ngIf="addForm.get('horaFin')?.hasError('required')">
              La hora de fin es requerida
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Tipo *</mat-label>
          <mat-select formControlName="tipo" required>
            <mat-option value="entrada">Entrada</mat-option>
            <mat-option value="salida">Salida</mat-option>
          </mat-select>
          <mat-error *ngIf="addForm.get('tipo')?.hasError('required')">
            El tipo es requerido
          </mat-error>
        </mat-form-field>

        <div class="form-row">
          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Grado *</mat-label>
            <mat-select formControlName="idGrado" required>
              <mat-option *ngFor="let grado of grados" [value]="grado.id">
                {{ grado.nombre }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="addForm.get('idGrado')?.hasError('required') || addForm.get('idGrado')?.hasError('min')">
              Seleccione un grado
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Sección *</mat-label>
            <mat-select formControlName="idSeccion" required>
              <mat-option *ngFor="let seccion of secciones" [value]="seccion.id">
                {{ seccion.nombre }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="addForm.get('idSeccion')?.hasError('required') || addForm.get('idSeccion')?.hasError('min')">
              Seleccione una sección
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Nivel *</mat-label>
            <mat-select formControlName="idNivel" required>
              <mat-option *ngFor="let nivel of niveles" [value]="nivel.id">
                {{ nivel.nombre }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="addForm.get('idNivel')?.hasError('required') || addForm.get('idNivel')?.hasError('min')">
              Seleccione un nivel
            </mat-error>
          </mat-form-field>
        </div>
      </ng-container>

    </form>

    
  </div>

  <div class="modal-actions" mat-dialog-actions>
    <button mat-button type="button" (click)="onCancel()" [disabled]="loading">
      Cancelar
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onSubmit()"
      [disabled]="addForm.invalid || loading"
      class="submit-btn">
      <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
      <span *ngIf="!loading">Guardar</span>
      <span *ngIf="loading">Guardando...</span>
    </button>
  </div>
</div>